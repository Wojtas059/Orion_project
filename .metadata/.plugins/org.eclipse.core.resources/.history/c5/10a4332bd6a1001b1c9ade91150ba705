

/************** MAKE CHANGES HERE ********************/
#include "stm32f4xx_hal.h"

#define TYPE_DHT11    // define according to your sensor
//#define TYPE_DHT22


#define PORT GPIOA
#define PIN GPIO_PIN_7




/*******************************************     NO CHANGES AFTER THIS LINE      ****************************************************/

#include "DHT.h"


unsigned char Reset_Pulse(void)
{
	unsigned char presence;
	HAL_GPIO_WritePin(PORT, PIN ,0);
	HAL_Delay(500);
	HAL_GPIO_WritePin(PORT, PIN ,1);
	HAL_Delay(30);
	if((HAL_GPIO_ReadPin(PORT, PIN))==0){
		presence = 1;
	}
	else
	{
		presence = 0;
	}
	HAL_Delay(470);
	if((HAL_GPIO_ReadPin(PORT, PIN))==1){
			presence = 1;
		}
		else
		{
			presence = 0;
		}
	return presence;

}



void send(char bit)
{
	HAL_GPIO_WritePin(PORT, PIN ,0);
	HAL_Delay(5);
	if(bit == 1)
		HAL_GPIO_WritePin(PORT, PIN ,1);

	HAL_Delay(80);
	HAL_GPIO_WritePin(PORT, PIN ,0);

}
unsigned char read(void)
{
	unsigned char presence;
	HAL_GPIO_WritePin(PORT, PIN ,0);
	HAL_Delay(2);
	HAL_GPIO_WritePin(PORT, PIN ,1);
	HAL_Delay(15);
	if((HAL_GPIO_ReadPin(PORT, PIN))==1){
				presence = 1;
			}
			else
			{
				presence = 0;
			}
	return presence;

}
void send_byte(char value)
{
	unsigned char i;
	unsigned char pom;

	for(i=0; i<8; i++)
	{
		pom = value >> i;
		pom &= 0x01;
		send(pom);
	}
	HAL_Delay(100);
}

unsigned char read_byte(void)
{
	unsigned char i;
	unsigned char value=0;

	for(i=0; i<8; i++)
	{
		if(read()){
			value |= 0x01 << i;
		}

		HAL_Delay(15);
	}
	return(value);


}






